{# templates/feed/partials/_composer.html #}
<div id="{{ composer_id|default:'composer' }}" class="composer card" style="width:80%; margin: 0 auto 24px;">
  <form action="{% url 'post_create' %}" method="post" enctype="multipart/form-data" id="composer-form">
    {% csrf_token %}

    <div class="composer-row composer-row-1">
      {% if request.user.is_authenticated and request.user.username %}
  <a class="avatar-sm avatar-link" href="{{ request.user.get_absolute_url }}">
    {% if request.user.avatar %}
      <img src="{{ request.user.avatar.url }}" alt="@{{ request.user.username }} avatar">
    {% else %}
      <div class="avatar-placeholder"></div>
    {% endif %}
  </a>
{% else %}
  <div class="avatar-sm">
    {% if request.user.is_authenticated and request.user.avatar %}
      <img src="{{ request.user.avatar.url }}" alt="avatar">
    {% else %}
      <div class="avatar-placeholder"></div>
    {% endif %}
  </div>
{% endif %}

      <div class="composer-input">
        {{ form.text }}
        {% if form.non_field_errors %}
          <div class="form-errors">{{ form.non_field_errors }}</div>
        {% endif %}
      </div>
    </div>

    {# where we will append hidden file inputs #}
    <div id="file-inputs"></div>

    {# preview area (keep as-is) #}
    <div class="thumb-grid-wrap" id="thumb-grid-wrap" hidden>
      <div class="thumb-grid" id="thumb-grid"></div>
      <button type="button" class="linklike" id="thumbs-toggle" hidden>Show more</button>
    </div>

    <div class="composer-row composer-row-2">
      <div class="left-actions">
        <button type="button" class="btn-secondary" id="add-photo">Photo</button>
        <button type="button" class="btn-secondary" id="add-video">Video</button>
      </div>
      <div class="right-actions">
        <button class="btn-primary" type="submit">Post</button>
      </div>
    </div>
  </form>
</div>